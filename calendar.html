<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous"></script>

  <style>
    ::-webkit-scrollbar { display: none; }

    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: #ffffff;
    }

    /* âœ… ë‹¬ë ¥ ì¹´ë“œ ë§ì¤„ì„ */
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    /* âœ… Footer Navigation ìƒ‰ìƒ */
    .nav-text-gray { color: #9CA3AF; }      /* ë¹„í™œì„± íšŒìƒ‰ */
    .nav-text-active { color: #4C8AD6; }    /* í™œì„± íŒŒë€ìƒ‰ */

    /* ğŸ”¥ Footerë¥¼ í˜ì´ì§€ ë¡œë”©ê³¼ ë™ì‹œì— í‘œì‹œ */
    footer {
      position: fixed;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 375px;
      z-index: 50;
      background: #fff;
      border-top: 1px solid #e5e7eb;
      box-shadow: 0 -2px 6px rgba(0,0,0,0.05);
    }
  </style>
</head>

<body class="bg-white font-[Noto Sans KR] flex items-center justify-center h-[812px]">
  <!-- âœ… ëª¨ë°”ì¼ í”„ë ˆì„: 375Ã—812 -->
  <div class="w-[375px] h-[812px] bg-white shadow-2xl overflow-hidden relative flex flex-col">

    <!-- í—¤ë” -->
    <header class="px-4 py-4 flex items-center justify-center relative border-b border-gray-100">
      <button onclick="location.href='index.html'" class="absolute left-4 text-gray-500 hover:text-blue-500 transition">
        <i class="fa-solid fa-house fa-lg"></i>
      </button>
      <h1 class="text-lg font-medium text-gray-700">í¸ì§€ ìº˜ë¦°ë”</h1>
    </header>

    <!-- ë©”ì¸ (ë„¤ë¹„ë°” ë†’ì´ë§Œí¼ ì—¬ë°± í™•ë³´) -->
    <main class="px-6 pt-4 pb-24 flex-1 overflow-y-auto">
      <!-- ì›” ë„¤ë¹„ê²Œì´ì…˜ -->
      <section class="flex items-center justify-between mb-4">
        <button id="prev-month" class="text-gray-500 hover:text-blue-500">
          <i class="fa-solid fa-chevron-left fa-xl"></i>
        </button>
        <h2 id="month-title" class="text-2xl font-bold text-gray-700"></h2>
        <button id="next-month" class="text-gray-500 hover:text-blue-500">
          <i class="fa-solid fa-chevron-right fa-xl"></i>
        </button>
      </section>

      <!-- ë‹¬ë ¥ -->
      <section>
        <div class="bg-white rounded-2xl p-4 shadow">
          <div id="calendar-grid" class="grid grid-cols-7 gap-y-2 text-center">
            <div class="font-medium text-gray-400 text-sm">ì¼</div>
            <div class="font-medium text-gray-400 text-sm">ì›”</div>
            <div class="font-medium text-gray-400 text-sm">í™”</div>
            <div class="font-medium text-gray-400 text-sm">ìˆ˜</div>
            <div class="font-medium text-gray-400 text-sm">ëª©</div>
            <div class="font-medium text-gray-400 text-sm">ê¸ˆ</div>
            <div class="font-medium text-gray-400 text-sm">í† </div>
          </div>
        </div>

        <div class="mt-4 flex items-center justify-center gap-6">
          <div class="flex items-center gap-2">
            <div class="w-2 h-2 bg-yellow-400 rounded-full"></div>
            <span class="text-sm text-gray-500">ë‹µì¥ í¸ì§€ê°€ ë„ì°©í•œ ë‚ </span>
          </div>
          <div class="flex items-center gap-2">
            <div class="w-0 h-0 border-l-[6px] border-l-transparent border-b-[6px] border-b-blue-400"></div>
            <span class="text-sm text-gray-500">ë‚´ê°€ í¸ì§€ë¥¼ ë³´ë‚¸ ë‚ </span>
          </div>
        </div>
      </section>

      <!-- í¸ì§€ ì¹´ë“œ -->
      <section id="letter-section" class="mt-6 opacity-0 transition-all">
        <div id="selected-date-title" class="mb-4">
          <h3 class="text-lg font-medium text-gray-700">ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
        </div>
        <div id="letter-cards-container" class="space-y-3"></div>
        <div id="sent-letters-container" class="space-y-3 mt-6"></div>
        <div id="no-letters-message" class="hidden text-center py-12 text-sm text-gray-400">
          í•´ë‹¹ ë‚ ì§œì—ëŠ” í¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.
        </div>
      </section>
    </main>

    <!-- âœ… Footer Navigation: í™”ë©´ ë¡œë“œ ì‹œ ì¦‰ì‹œ ë³´ì´ë„ë¡ -->
    <footer class="flex justify-around items-center py-2">
      <!-- í™ˆ(ë¹„í™œì„±) -->
      <div onclick="window.location.href='index.html'" class="flex flex-col items-center nav-text-gray cursor-pointer">
        <i class="fa-solid fa-house text-xl"></i>
        <span class="text-xs mt-1">í™ˆ</span>
      </div>

      <!-- í¸ì§€í•¨(ë¹„í™œì„±) -->
      <div onclick="window.location.href='mailbox.html'" class="flex flex-col items-center nav-text-gray cursor-pointer">
        <i class="fa-solid fa-envelope text-xl"></i>
        <span class="text-xs mt-1">í¸ì§€í•¨</span>
      </div>

      <!-- ë‹¬ë ¥(í™œì„±) -->
      <div onclick="window.location.href='calendar.html'" class="flex flex-col items-center nav-text-active cursor-pointer">
        <i class="fa-solid fa-calendar-days text-xl"></i>
        <span class="text-xs mt-1">ë‹¬ë ¥</span>
      </div>
    </footer>
  </div>

<script>
  // ê¸°ì¡´ ë‹¬ë ¥ ìŠ¤í¬ë¦½íŠ¸ ìœ ì§€
  function getIcon(a){
    return a==='cloud'?'fa-solid fa-cloud':a==='dog'?'fa-solid fa-dog':'fa-solid fa-user-tie';
  }
  function getColor(a){
    return a==='cloud'?'from-blue-200 to-blue-300':a==='dog'?'from-orange-200 to-orange-300':'from-green-200 to-green-300';
  }

  const letterData={
    "2025-10-07":[{sender:"ì¹œêµ¬",avatar:"cloud",preview:"10ì›” 7ì¼! ì˜¤ëŠ˜ í¸ì§€ ë„ì°©",date:"10ì›” 7ì¼"}],
    "2025-10-22":[{sender:"ì‚¼ì´Œ",avatar:"user-tie",preview:"ê°€ì„ì´ë„¤ ê±´ê°• ì±™ê²¨ë¼",date:"10ì›” 22ì¼"}],
    "2025-10-30":[{sender:"ë½€ë¯¸",avatar:"dog",preview:"ë©ë©! ë‹¨í’ ì˜ˆë»",date:"10ì›” 30ì¼"}],
  };

  const sentLetters={};
  for(const k in letterData){
    const [y,m,d]=k.split('-');
    sentLetters[k]=[{title:"ë³´ë‚¸ í¸ì§€",preview:"ì˜¤ëŠ˜ì˜ ë§ˆìŒì„ ì „í–ˆì–´ìš”.",date:`${+m}ì›” ${+d}ì¼`}];
  }

  const today=new Date();
  let currentYear=today.getFullYear();
  let currentMonth=today.getMonth();

  const monthTitle=document.getElementById('month-title');
  const grid=document.getElementById('calendar-grid');
  const letterSection=document.getElementById('letter-section');
  const title=document.getElementById('selected-date-title');
  const letterBox=document.getElementById('letter-cards-container');
  const sentBox=document.getElementById('sent-letters-container');
  const noMsg=document.getElementById('no-letters-message');

  function renderCalendar(){
    monthTitle.textContent=`${currentYear}ë…„ ${currentMonth+1}ì›”`;
    grid.querySelectorAll('.calendar-date').forEach(e=>e.remove());
    const firstDay=new Date(currentYear,currentMonth,1).getDay();
    const lastDate=new Date(currentYear,currentMonth+1,0).getDate();

    for(let i=0;i<firstDay;i++){
      const empty=document.createElement('div');
      grid.appendChild(empty);
    }

    for(let d=1;d<=lastDate;d++){
      const cell=document.createElement('div');
      cell.className='calendar-date py-3 cursor-pointer hover:bg-gray-50 rounded relative text-gray-700';
      cell.dataset.date=d;
      cell.textContent=d;

      const key=`${currentYear}-${String(currentMonth+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
      if(letterData[key]){
        const dot=document.createElement('div');
        dot.className='w-1.5 h-1.5 bg-yellow-400 rounded-full mx-auto mt-1';
        cell.appendChild(dot);
      }
      grid.appendChild(cell);
    }
    attachDateEvents();

    if(currentYear===today.getFullYear() && currentMonth===today.getMonth()){
      const todayCell=[...document.querySelectorAll('.calendar-date')]
        .find(c=>+c.dataset.date===today.getDate());
      if(todayCell) todayCell.click();
    } else {
      letterSection.style.opacity='0';
      title.innerHTML='<h3 class="text-lg font-medium text-gray-700">ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>';
    }
  }

  function attachDateEvents(){
    document.querySelectorAll('.calendar-date').forEach(c=>{
      c.addEventListener('click',()=>{
        document.querySelectorAll('.calendar-date').forEach(e=>e.classList.remove('bg-yellow-100'));
        c.classList.add('bg-yellow-100');
        title.innerHTML=`<h3 class="text-lg font-medium text-gray-700">${currentMonth+1}ì›” ${c.dataset.date}ì¼ì˜ í¸ì§€</h3>`;
        renderLetters(c.dataset.date);
      });
    });
  }

  function renderLetters(day){
    letterBox.innerHTML='';
    sentBox.innerHTML='';
    noMsg.classList.add('hidden');
    const key=`${currentYear}-${String(currentMonth+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
    const replies=letterData[key]||[];
    const sent=sentLetters[key]||[];

    if(replies.length===0 && sent.length===0){
      noMsg.classList.remove('hidden');
      letterSection.style.opacity='1';
      return;
    }

    replies.forEach(l=>{
      letterBox.innerHTML+=`
        <div onclick="location.href='recipient.html'"
             class="bg-white rounded-xl p-4 shadow hover:shadow-lg cursor-pointer">
          <div class="flex items-start gap-3">
            <div class="w-10 h-10 rounded-full bg-gradient-to-br ${getColor(l.avatar)} flex items-center justify-center">
              <i class="${getIcon(l.avatar)} text-white text-sm"></i>
            </div>
            <div class="flex-1">
              <div class="flex justify-between mb-1">
                <h4 class="font-bold text-gray-700">${l.sender}</h4>
                <span class="text-xs text-gray-400">${l.date}</span>
              </div>
              <p class="text-sm text-gray-500 line-clamp-2">${l.preview}</p>
            </div>
          </div>
        </div>`;
    });

    sent.forEach(s=>{
      sentBox.innerHTML+=`
        <div onclick="location.href='recipient.html'"
             class="bg-blue-50 rounded-xl p-4 border border-blue-100 shadow hover:shadow-lg cursor-pointer">
          <div class="flex items-start gap-3">
            <div class="w-10 h-10 rounded-full bg-blue-400 flex items-center justify-center">
              <i class="fa-solid fa-paper-plane text-white text-sm"></i>
            </div>
            <div class="flex-1">
              <div class="flex justify-between mb-1">
                <h4 class="font-bold text-gray-700">${s.title}</h4>
                <span class="text-xs text-gray-400">${s.date}</span>
              </div>
              <p class="text-sm text-gray-500 line-clamp-2">${s.preview}</p>
            </div>
          </div>
        </div>`;
    });

    letterSection.style.opacity='1';
  }

  document.getElementById('prev-month').addEventListener('click',()=>{
    if(currentMonth===0){currentMonth=11;currentYear--;} else currentMonth--;
    renderCalendar();
  });

  document.getElementById('next-month').addEventListener('click',()=>{
    if(currentMonth===11){currentMonth=0;currentYear++;} else currentMonth++;
    renderCalendar();
  });

  renderCalendar();
</script>
</body>
</html>
